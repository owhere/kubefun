{% extends "base.html" %}
{% block content %}

<!-- Cluster Information Section -->
<div class="w3-card w3-padding w3-margin-bottom" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
    <p style="margin: 0;"><strong>Cluster Name:</strong> {{ cluster_info.cluster_name }}</p>
    <p style="margin: 0;"><strong>API Server:</strong> {{ cluster_info.api_server }}</p>
    <p style="margin: 0;"><strong>Health Status:</strong> 
        <span class="w3-tag w3-round {% if cluster_info.health_status == 'Healthy' %}w3-green{% else %}w3-red{% endif %}">
            {{ cluster_info.health_status }}
        </span>
    </p>
</div>
<div class="w3-card w3-padding w3-margin-bottom" style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap;">
    <p style="margin: 0;"><strong>Total Nodes:</strong> 
        <span class="{% if cluster_info.healthy_nodes == cluster_info.total_nodes %}w3-green{% else %}w3-red{% endif %}">
            {{ cluster_info.healthy_nodes }} / {{ cluster_info.total_nodes }}
        </span> 
    </p>
    <p style="margin: 0;">Total Namespaces: <strong>{{ cluster_info.total_namespaces }}</strong></p>
    <p style="margin: 0;">Total Pods: <strong>{{ cluster_info.total_pods }}</strong></p>
    <p style="margin: 0;">Total Deployments:<strong>{{ cluster_info.total_deployments }}</strong></p>
    <p style="margin: 0;">Total Services: <strong>{{ cluster_info.total_services }}</strong></p>
</div>

<h3>Top Nodes by Resource Usage</h3>
<table id="nodesTable" class="w3-table w3-bordered w3-striped">
    <thead>
        <tr>
            <th>Node</th>
            <th>CPU Usage</th>
            <th>Memory Usage</th>
        </tr>
    </thead>
    <tbody>
        {% for node in top_nodes %}
        <tr>
            <td>{{ node.name }}</td>
            <td>{{ node.cpu }}</td>
            <td>{{ node.memory }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<h3>Top Pods by Resource Usage</h3>
<table id="podsTable" class="w3-table w3-bordered w3-striped">
    <thead>
        <tr>
            <th>Pod</th>
            <th>Namespace</th>
            <th>CPU Usage</th>
            <th>Memory Usage</th>
        </tr>
    </thead>
    <tbody>
        {% for pod in top_pods %}
        <tr>
            <td>{{ pod.name }}</td>
            <td>{{ pod.namespace }}</td>
            <td>{{ pod.cpu }}</td>
            <td>{{ pod.memory }}</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<script>
    $(document).ready(function() {
        $('#nodesTable').DataTable();
        $('#podsTable').DataTable();
    });
</script>
{% endblock %}
